import pandas as pd
from openpyxl import load_workbook

# Load the Excel file
file_path = 'your_excel_file.xlsx'
df = pd.read_excel(file_path)

# Filter the DataFrame to only include rows where the Location is "Singapore"
filtered_df = df[df['Location'] == 'Singapore']

# Load the existing workbook
book = load_workbook(file_path)

# Create a new Excel writer object
with pd.ExcelWriter(file_path, engine='openpyxl', mode='a') as writer:
    # Load the workbook into the writer
    writer.book = book
    
    # Write the filtered DataFrame to a new sheet named 'FilteredData'
    filtered_df.to_excel(writer, sheet_name='FilteredData', index=False)

print("Filtered data added to a new sheet 'FilteredData' in the existing Excel file.")
