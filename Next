import win32com.client
import time

def update_embedded_excel(ppt_file):
    try:
        # Initialize PowerPoint application
        powerpoint = win32com.client.Dispatch("PowerPoint.Application")
        presentation = powerpoint.Presentations.Open(ppt_file)
        excel_app = win32com.client.Dispatch("Excel.Application")

        # Loop through slides to find charts
        for slide in presentation.Slides:
            for shape in slide.Shapes:
                if shape.HasChart:
                    chart = shape.Chart
                    chart.ChartData.Activate()
                    
                    # Access embedded Excel
                    workbook = excel_app.Workbooks(chart.ChartData.Workbook.FullName)
                    worksheet = workbook.Worksheets(1)

                    # Modify values in the embedded Excel
                    # Assume modifying some cells (e.g., A2, B2, C2)
                    worksheet.Cells(2, 1).Value = "Modified Value 1"
                    worksheet.Cells(2, 2).Value = "Modified Value 2"
                    worksheet.Cells(2, 3).Value = "Modified Value 3"
                    worksheet.Cells(2, 4).Value = "Modified Value 4"
                    
                    # Save and close the workbook
                    workbook.Save()
                    workbook.Close()
                    
                    # Exit the loop after modifying the first chart found
                    break

        # Save and close the presentation
        presentation.Save()
        presentation.Close()
        powerpoint.Quit()
        excel_app.Quit()
        
        print("Excel values updated successfully.")
        
    except Exception as e:
        print(f"An error occurred: {e}")

# Path to the PowerPoint file
ppt_file_path = "path/to/your/presentation.pptx"

update_embedded_excel(ppt_file_path)
