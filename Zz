import pandas as pd
from openpyxl import load_workbook

# Load the Excel file into a DataFrame
file_path = 'your_excel_file.xlsx'
df = pd.read_excel(file_path)

# Filter the DataFrame to only include rows where the Location is "Singapore"
filtered_df = df[df['Location'] == 'Singapore']

# Load the existing workbook
book = load_workbook(file_path)

# Use ExcelWriter to write to the existing workbook without overwriting it
with pd.ExcelWriter(file_path, engine='openpyxl', mode='a', if_sheet_exists='new') as writer:
    writer.book = book  # Use the loaded workbook
    writer.sheets = {ws.title: ws for ws in book.worksheets}  # Load existing sheets into the writer
    
    # Write the filtered DataFrame to a new sheet named 'FilteredData'
    filtered_df.to_excel(writer, sheet_name='FilteredData', index=False)

print("Filtered data added to a new sheet 'FilteredData' in the existing Excel file.")
